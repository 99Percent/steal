<!DOCTYPE html>

<!--[if lt IE 7]>
<html class="no-js ie lt-ie9 lt-ie8 lt-ie7" lang="en">
<![endif]-->
<!--[if IE 7]>
<html class="no-js ie lt-ie9 lt-ie8" lang="en">
<![endif]-->
<!--[if IE 8]>
<html class="no-js ie lt-ie9" lang="en">
<![endif]-->
<!--[if IE 9]>
<html class="no-js ie ie9" lang="en">
<![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>StealJS - Progressive Loading </title>
	<meta name="description" content="">
	<meta name="author" content="">

	
		<link rel="stylesheet" type="text/css" href="./static/bundles/static.css">
	
	<!--[if lt IE 9]>
   <script type="text/javascript" src="static/html5shiv.js"></script>
    <!--<![endif]-->
</head>

<body class="docs ">
	<header>
		<nav class="container">

			<div class="logo-menu">
				<a class="brand" href="../index.html">StealJS</a>
				<ul class="dropdown-menu">
		          <li><a href="http://javascriptmvc.com">JavaScriptMVC</a></li>
		          <li><a href="http://canjs.com">CanJS</a></li>
		          <li><a href="http://jquerypp.com">jQuery++</a></li>
		          <li class="active"><a href="http://stealjs.com">StealJS</a></li>
		          <li><a href="http://funcunit.com">FuncUnit</a></li>
		          <li><a href="http://documentjs.com">DocumentJS</a></li>
		        </ul>
			</div>
			<ul class="nav">
        <li ><a href="http://stealjs.com">Home</a></li>
        
          <li class="active"><a href="../docs/index.html">Api</a></li>
        
	          <li class=""><a href="https://twitter.com/stealjs">Twitter</a></li>
		      <li class=""><a href="https://github.com/stealjs/steal">GitHub</a></li>
		      <li class=""><a href="https://gitter.im/stealjs/steal">Chat</a></li>
	        </ul>
			<div class="pull-right">
				<div class="bitovi-menu">
					<a href="http://bitovi.com" class="bitovi icon-bits">Bitovi</a>
					<ul class="dropdown-menu">
						<li><a href="http://bitovi.com">Bitovi.com</a></li>
						<li><a href="http://bitovi.com/blog">Blog</a></li>
						<li><a href="http://bitovi.com/development">Development</a></li>
						<li><a href="http://bitovi.com/design">Design</a></li>
						<li><a href="http://bitovi.com/training">Training</a></li>
						<li><a href="http://bitovi.com/open-source">Open Source</a></li>
						<li><a href="http://bitovi.com/about">About</a></li>
						<li><a href="http://bitovi.com/contact">Contact Us</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>

	
<div class="container api">

	
	<nav class="sidebar">
		
		<ul class="api cascading primary-grouping"> 
	
		
		
			<li class="search-container active">
			<a class="sidebar-title" href="index.html" data-search="StealJS">
				StealJS
			</a>
			
	<ul>
		
			
				
					
					<li class="heading search-container">
						<span>apis</span>
						
	<ul>
		
			
				
				
				<li class="search-container">
					<a class="page" href="steal.html" data-search="steal">
						steal
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="page" href="steal-tools.html" data-search="steal-tools">
						steal-tools
					</a>
				</li>
				
			
			
		
	</ul>


					</li>
					
				
				
			
			
		
			
				
					
					<li class="heading search-container">
						<span>guides</span>
						
	<ul>
		
			
				
				
				<li class="search-container">
					<a class="page" href="StealJS.why.html" data-search="Why StealJS">
						Why StealJS
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="page" href="StealJS.quick-start.html" data-search="Quick Start">
						Quick Start
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container active">
					<a class="page" href="steal-tools.guides.progressive_loading.html" data-search="Progressive Loading">
						Progressive Loading
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="page" href="StealJS.project-exporting.html" data-search="Project Exporting">
						Project Exporting
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="page" href="StealJS.changelog.html" data-search="Changelog">
						Changelog
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="page" href="StealJS.migrating.html" data-search="Migrating">
						Migrating
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="page" href="StealJS.roadmap.html" data-search="Roadmap">
						Roadmap
					</a>
				</li>
				
			
			
		
			
				
				
				<li class="search-container">
					<a class="page" href="guides.Contributing.html" data-search="Contributing">
						Contributing
					</a>
				</li>
				
			
			
		
	</ul>


					</li>
					
				
				
			
			
		
	</ul>


		</li>
		
	
</ul>

	</nav>
	
	
	
	<article class="content docs">
	
	
		
		<section class="title">
			<div class="heading">
<h1>Progressive Loading</h1>
	<ul class="tags">
		<li>page</li>
	</ul>
	
	
</div>

<div class="sub-heading">
	
	
		<span class="module">steal-tools.guides.progressive_loading</span>
	
	
	
	<span class="inherits">&nbsp;</span>
</div>

<ul class="links">
    
	
		<li><a href="">source</a></li>
	
	
	
</ul>
<br />
		</section>
		
		
		
		<section class="contents">
		</section>
		
		
		

		
		<section class="description">
			<p>Single page apps and regular web pages typically load several, sometimes dozens, of javascript files which causes long initial page load times.
Concatenating and minifying your scripts can help but the web page still loads files it doesn't need. Progressive loading solves this problem by loading only the scripts required and lazy loading the remaining files as needed. The example app below demonstrates a basic single page app with progressive loading.</p>

		</section>
		

		
			
		
		
		
		

		
		<section class="comment">
			<p>This guide is a step-by-step guide to create the app from scratch, or you can clone the source from the <a href="https://github.com/stealjs/progressive-loading">GitHub Quick Start repo</a>.</p>
<h2>Setup</h2>
<p>This basic single page app demonstrates progressive loading. It uses a common file structure, but Steal supports a wide variety of other configuration options which can be found <a href="steal.html">here</a>.</p>
<p>To get started, ensure <a href="http://nodejs.org/">Node.js</a> and <a href="http://bower.io/">bower</a> are properly installed on your computer, then initialize a <code>package.json</code> and install <a href="steal-tools.html">steal-tools</a>.</p>
<pre><code>&gt; npm init
&gt; npm install steal-tools --save-dev
</code></pre>
<p>Next, initialize <code>bower</code> and install <code>jquery</code> and <code>steal</code>.</p>
<pre><code>&gt; bower init
&gt; bower install jquery --save
&gt; bower install steal --save
</code></pre>
<p>If you already have a webserver running locally, you can skip this step. If you don't have a web server, install this simple command-line <a href="https://www.npmjs.com/package/http-server">http-server</a> to help you get started.</p>
<pre><code>&gt; npm install http-server -g
</code></pre>
<h2>Create your modules</h2>
<p>Create a main module that loads only the bare minimum to determine what &quot;page&quot; you are on. A bare bones example might have a file structure like:</p>
<pre><code>bower_components/
  steal/
    steal.js
  jquery/
    jquery.js
node_modules/
  steal-tools/
site/
  app.js
  config.js
  homepage.js
  login.js
  signup.js
  site.html
</code></pre>
<p>Create <code>app.js</code> which imports jquery using ES6 module syntax. We'll use the <code>hashchange</code> as a simple mechanism to
track the state of our app. So create an event handler which listens to the <code>hashchange</code> event. The hashes<code>#login</code>, <code>signup</code> and <code>#homepage</code> coorespond to a state or &quot;page&quot;. Steal-tools will load only the files needed for each state.</p>
<p><code>app.js</code></p>
<pre><code>import $ from 'jquery';
$(function(){
  var onhashchange = function(){
    if(window.location.hash === &quot;#login&quot;) {
      System.import(&quot;login&quot;).then(function(){
        $(&quot;#main&quot;).login();
      });
    } else if(window.location.hash === &quot;#signup&quot; ) {
      System.import(&quot;signup&quot;).then(function(){
        $(&quot;#main&quot;).signup();
      });
    } else {
      System.import(&quot;homepage&quot;).then(function(){
        $(&quot;#main&quot;).homepage();
      });
    }
  };
  $(window).bind(&quot;hashchange&quot;,onhashchange);
  onhashchange();
});
</code></pre>
<p><code>homepage.js</code></p>
<pre><code>define(['jquery'], function($){
  return $.fn.homepage = function(){
    this.html(&quot;&lt;h1&gt;Homepage&lt;/h1&gt;&quot;);
  };
});
</code></pre>
<p><code>signup.js</code></p>
<pre><code>module.exports = $.fn.signup = function(){
  this.html(&quot;&lt;h1&gt;Signup&lt;/h1&gt;&quot;);
};
</code></pre>
<p><code>login.js</code></p>
<pre><code>module.exports = $.fn.login = function() {
  this.html(&quot;&lt;h1&gt;Login&lt;/h1&gt;&quot;);
};
</code></pre>
<p><code>config.js</code></p>
<pre><code>System.bundle = [&quot;homepage&quot;,&quot;signup&quot;,&quot;login&quot;];
System.paths.jquery = &quot;../bower_components/jquery/dist/jquery.js&quot;;
</code></pre>
<h2>Create your page</h2>
<p>Now we'll create the <code>site.html</code> page which loads <code>steal.js</code>. The <code>data-main</code> and <code>data-config</code> attributes tell steal to load <code>config.js</code>, and <code>app.js</code>.</p>
<p><code>site.html</code></p>
<pre><code>&lt;div id=&quot;main&quot;&gt;&lt;/div&gt;

&lt;ul&gt;
    &lt;li&gt;&lt;a href='#homepage'&gt;home page&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href='#signup'&gt;sign up&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href='#login'&gt;log in&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;script src=&quot;../bower_components/steal/steal.js&quot;
        data-main=&quot;app&quot;
        data-config=&quot;./config.js&quot;
        &gt;&lt;/script&gt;
</code></pre>
<p>This is the development mode which progressively loads the scripts but doesn't use the concatenated or minified versions.</p>
<h2>Build your site</h2>
<p>From your main folder, run:</p>
<pre><code>&gt; ./node_modules/steal-tools/bin/steal build --main=app --config=site/config.js
</code></pre>
<p>The path to <code>config.js</code> must be relative to your cwd. This command generates a bundle <code>site/dist/bundles</code>.
The directory should have a file structure like:</p>
<pre><code>site/dist/bundles/
  app.js
  homepage.js
  signup.js
  login.js
</code></pre>
<p>Open site.html in your browser, and open the Network panel in the Developer Tools. As you click on the &quot;home page&quot;, &quot;sign up&quot; and &quot;log in&quot; links you'll notice the individual scripts loading as needed. This is progressive loading in action. Only the necessary scripts were loaded initially, the remaining scripts are loaded as needed. If you want to control number of scripts in a bundle, you can configure it like:</p>
<pre><code>&gt; ./node_modules/steal-tools/bin/steal build --main=app --config=site/config.js --bundleDepth=3
</code></pre>
<h2>See it live</h2>
<p>For production, add <code>data-env=&quot;production&quot;</code> attribute to your script tag. This tells Steal to use the concatenated and minified versions of the files:</p>
<pre><code>&lt;div id=&quot;main&quot;&gt;&lt;/div&gt;
&lt;script src=&quot;../bower_components/steal/steal.js&quot;
        data-main=&quot;app&quot;
        data-config=&quot;./config&quot;
        data-env=&quot;production&quot;&gt;&lt;/script&gt;
</code></pre>
<p>Again, open the <code>site.html</code> in a browser and view the Network tab in the Developer Tools. You notice <code>app.js</code> now contains a minified and concatenated version of jquery and config.js. And the <code>homepage.js</code>, <code>signup.js</code> and <code>login.js</code> are only loaded when needed.</p>

		</section>
		
		

		
	
	
	</article>
	
	

</div>






	<footer>
		<nav class="container">
			<a class="brand javascriptmvc" href="index.html"></a>
		</nav>
	</footer>
	<script type="text/javascript">
		var docObject = {"type":"page","name":"steal-tools.guides.progressive_loading","src":"steal-tools/doc/guides/progressive_loading.md","description":"Single page apps and regular web pages typically load several, sometimes dozens, of javascript files which causes long initial page load times.\nConcatenating and minifying your scripts can help but the web page still loads files it doesn't need. Progressive loading solves this problem by loading only the scripts required and lazy loading the remaining files as needed. The example app below demonstrates a basic single page app with progressive loading.","title":"Progressive Loading","parent":"StealJS.guides","order":1,"templates":"/Users/matthew/Projects/steal/theme/templates","static":"/Users/matthew/Projects/steal/theme/static","glob":{"pattern":"{steal/docs,steal-tools/doc,steal-tools/lib}/**/*.+(md|js)","ignore":["**/{node_modules,bower_components}/**/*"],"cwd":"/Users/matthew/Projects/steal"},"dest":"/Users/matthew/Projects/steal/docs","watch":true,"generators":["html"],"docConfigDest":"../documentjs.json","project":{}};
	</script>
	
	
		<script>
		  steal = {
		    instantiated: {
		      "bundles/static.css!$css" : null
		    }
		  }
		</script>
		<script type='text/javascript' 
				data-main="static"
				data-config="./static/config.js"
				src="./static/steal.production.js"
		    		bundles-path="bundles"></script>
		<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-2302003-20', 'auto');
		ga('send', 'pageview');
		</script>
	
</body>

</html>
